<!DOCTYPE html>
<html>
<head>
  <title>Voice Item Kiosk</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- <h2>ðŸŽ¤ Voice-Controlled Food Kiosk</h2> -->
  <div class="grid" id="items"></div>
  <div id="total-bar">TOTAL: â‚¹0</div>

  <script>
    const shownIds = new Set();
    let total = 0;

    async function fetchItem() {
      try {
        const res = await fetch('http://localhost:5000/latest_item');
        const data = await res.json();

        if (data.id && !shownIds.has(data.id)) {
          const div = document.createElement('div');
          div.className = 'item';
          div.innerHTML = `
            <div class="image-wrapper">
              <img src="${data.image}" alt="${data.name}">
            </div>
            <div class="content-wrapper">
              <h3>${data.name}</h3>
              <div class="price">â‚¹${data.price}</div>
              <div><strong>Ingredients:</strong></div>
              <ul>${(data.ingredients || []).map(ing => `<li>${ing}</li>`).join('')}</ul>
            </div>
          `;
          document.getElementById("items").appendChild(div);
          shownIds.add(data.id);

          // Animate entrance
          requestAnimationFrame(() => {
            div.classList.add('show');
          });

          // Update total
          total += data.price || 0;
          document.getElementById("total-bar").innerText = `TOTAL: â‚¹${total}`;
        }
      } catch (error) {
        console.error("Failed to fetch item:", error);
      }
    }

    setInterval(fetchItem, 3000); // Poll every 3s
  </script>
</body>
</html>
